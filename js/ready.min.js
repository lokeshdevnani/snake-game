$(document).ready(function(){function n(){"undefined"!=typeof S&&clearInterval(S),S=setInterval(f,80),T=!0}function t(){clearInterval(S),T=!1}function e(n){t(),isSpawning=!0,setTimeout(function(){y(n)},100),setTimeout(function(){y(n),i()},2e3)}function i(){isSpawning=!1,v="right",o(),r(),w=0,a()}function o(){var n=5;m=[];for(var t=n-1;t>=0;t--)m.push({x:t,y:0})}function r(){O={x:Math.round(Math.random()*(M-I)/I),y:Math.round(Math.random()*(A-I)/I)}}function f(){u(),a()}function a(){d(),h(),x(O,0),s()}function u(){var n={x:m[0].x,y:m[0].y};"right"==v?n.x++:"left"==v?n.x--:"up"==v?n.y--:"down"==v&&n.y++,"right"==p?O.x++:"left"==p?O.x--:"up"==p?O.y--:"down"==p&&O.y++,l(n)||g(n,m)?e("SNAKE Crashed!!!"):l(O)||c(n,O)?e("FOOD Captured!!!"):w++,w%5&&m.pop(),m.unshift(n)}function c(n,t){if(n.x==t.x&&n.y==t.y)return!0;for(var e=0;e<m.length;e++)if(m[e].x==t.x&&m[e].y==t.y)return!0;return!1}function l(n){return-1==n.x||n.x==M/I||-1==n.y||n.y==A/I}function d(){C.clearRect(0,0,M,A)}function h(){for(var n=0;n<m.length;n++)x(m[n],1)}function x(n,t){C.beginPath(),C.fillStyle=t?"#2B3":"orange",C.arc(n.x*I+I/2,n.y*I+I/2,I/2,0,2*Math.PI),C.strokeStyle="black",C.fill(),C.stroke()}function s(){var n="Score: "+w;C.font="15px Arial",C.textAlign="left",C.fillText(n,5,A-5)}function y(n){C.font="bold 30px verdana, sans-serif",C.fillStyle="#ff0000",C.textAlign="center",C.fillText(n,M/2,A/2)}function g(n,t){for(var e=1;e<t.length;e++)if(t[e].x==n.x&&t[e].y==n.y)return!0;return!1}var v,p,w,S,m,O,k=$("#canvas")[0],C=k.getContext("2d"),M=$("#canvas").width(),A=$("#canvas").height(),I=15,T=!1,b=[37,38,39,40],D=[65,87,68,83],P=[72,75,76,74],B={wasd:D,vim:P,arrow:b},E=b,F=D,K=["up","right","down","left"],N=!1,R=!1;$("#snakeControls").change(function(){E=B[$(this).val()]}),$("#foodControls").change(function(){F=B[$(this).val()]}),i(),$(document).keydown(function(e){var i=e.which;e.preventDefault(),N?i==E[0]?v=K[(K.indexOf(v)+3)%4]:i==E[2]&&(v=K[(K.indexOf(v)+1)%4]):i==E[0]&&"right"!=v?v="left":i==E[1]&&"down"!=v?v="up":i==E[2]&&"left"!=v?v="right":i==E[3]&&"up"!=v&&(v="down"),R?i==F[0]?p=K[(K.indexOf(v)+3)%4]:i==F[2]&&(p=K[(K.indexOf(v)+1)%4]):i==F[0]?p="left":i==F[1]?p="up":i==F[2]?p="right":i==F[3]&&(p="down"),"82"==i?n():"80"==i&&t(),T||isSpawning||"80"==i||n()})});